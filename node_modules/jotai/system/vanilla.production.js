System.register([],function(M){"use strict";return{execute:function(){M("atom",P);let N=0;function P(t,r){const c=`atom${++N}`,a={toString(){return c}};return typeof t=="function"?a.read=t:(a.init=t,a.read=R,a.write=T),r&&(a.write=r),a}function R(t){return t(this)}function T(t,r,c){return r(this,typeof c=="function"?c(t(this)):c)}const O=(t,r)=>t.unstable_is?t.unstable_is(r):r===t,W=t=>"init"in t,q=t=>!!t.write,b=new WeakMap,z=t=>{var r;return A(t)&&!((r=b.get(t))!=null&&r[1])},U=(t,r)=>{const c=b.get(t);c&&(c[1]=!0,c[0].forEach(a=>a(r)))},$=t=>{if(b.has(t))return;const r=[new Set,!1];b.set(t,r);const c=()=>{r[1]=!0};t.then(c,c),t.onCancel=a=>{r[0].add(a)}},A=t=>typeof(t==null?void 0:t.then)=="function",B=t=>"v"in t||"e"in t,k=t=>{if("e"in t)throw t.e;return t.v},F=(t,r,c)=>{c.p.has(t)||(c.p.add(t),r.then(()=>{c.p.delete(t)},()=>{c.p.delete(t)}))},G=(t,r,c,a,y)=>{var h;c.d.set(a,y.n),z(c.v)&&F(r,c.v,y),(h=y.m)==null||h.t.add(r),t&&x(t,a,r)},g=()=>[new Map,new Map,new Set],H=(t,r,c)=>{t[0].has(r)||t[0].set(r,new Set),t[1].set(r,c)},x=(t,r,c)=>{const a=t[0].get(r);a&&a.add(c)},K=(t,r)=>t[0].get(r),I=(t,r)=>{t[2].add(r)},p=t=>{for(;t[1].size||t[2].size;){t[0].clear();const r=new Set(t[1].values());t[1].clear();const c=new Set(t[2]);t[2].clear(),r.forEach(a=>{var y;return(y=a.m)==null?void 0:y.l.forEach(h=>h())}),c.forEach(a=>a())}},J=(...[t,r,c,a])=>{const y=(i,e,n)=>{const s="v"in e,o=e.v,l=z(e.v)?e.v:null;if(A(n)){$(n);for(const u of e.d.keys())F(i,n,t(u));e.v=n,delete e.e}else e.v=n,delete e.e;(!s||!Object.is(o,e.v))&&(++e.n,l&&U(l,n))},h=(i,e,n)=>{var s;const o=t(e);if(B(o)&&(o.m&&!(n!=null&&n.has(e))||Array.from(o.d).every(([f,S])=>h(i,f,n).n===S)))return o;o.d.clear();let l=!0;const u=f=>{if(O(e,f)){const w=t(f);if(!B(w))if(W(f))y(f,w,f.init);else throw new Error("no atom init");return k(w)}const S=h(i,f,n);if(l)G(i,e,o,f,S);else{const w=g();G(w,e,o,f,S),E(w,e,o),p(w)}return k(S)};let d,v;const m={get signal(){return d||(d=new AbortController),d.signal},get setSelf(){return!v&&q(e)&&(v=(...f)=>{if(!l)return L(e,...f)}),v}};try{const f=r(e,u,m);if(y(e,o,f),A(f)){(s=f.onCancel)==null||s.call(f,()=>d==null?void 0:d.abort());const S=()=>{if(o.m){const w=g();E(w,e,o),p(w)}};f.then(S,S)}return o}catch(f){return delete o.v,o.e=f,++o.n,o}finally{l=!1}},V=i=>k(h(void 0,i)),X=(i,e,n)=>{var s,o;const l=new Map;for(const u of((s=n.m)==null?void 0:s.t)||[])l.set(u,t(u));for(const u of n.p)l.set(u,t(u));return(o=K(i,e))==null||o.forEach(u=>{l.set(u,t(u))}),l},Y=(i,e,n)=>{const s=[],o=new Set,l=(d,v)=>{if(!o.has(d)){o.add(d);for(const[m,f]of X(i,d,v))d!==m&&l(m,f);s.push([d,v,v.n])}};l(e,n);const u=new Set([e]);for(let d=s.length-1;d>=0;--d){const[v,m,f]=s[d];let S=!1;for(const w of m.d.keys())if(w!==v&&u.has(w)){S=!0;break}S&&(h(i,v,o),E(i,v,m),f!==m.n&&(H(i,v,m),u.add(v))),o.delete(v)}},_=(i,e,...n)=>c(e,s=>k(h(i,s)),(s,...o)=>{const l=t(s);let u;if(O(e,s)){if(!W(s))throw new Error("atom not writable");const d="v"in l,v=l.v,m=o[0];y(s,l,m),E(i,s,l),(!d||!Object.is(v,l.v))&&(H(i,s,l),Y(i,s,l))}else u=_(i,s,...o);return p(i),u},...n),L=(i,...e)=>{const n=g(),s=_(n,i,...e);return p(n),s},E=(i,e,n)=>{if(n.m&&!z(n.v)){for(const s of n.d.keys())n.m.d.has(s)||(j(i,s,t(s)).t.add(e),n.m.d.add(s));for(const s of n.m.d||[])if(!n.d.has(s)){n.m.d.delete(s);const o=D(i,s,t(s));o==null||o.t.delete(e)}}},j=(i,e,n)=>{if(!n.m){h(i,e);for(const s of n.d.keys())j(i,s,t(s)).t.add(e);if(n.m={l:new Set,d:new Set(n.d.keys()),t:new Set},q(e)){const s=n.m;I(i,()=>{const o=a(e,(...l)=>_(i,e,...l));o&&(s.u=o)})}}return n.m},D=(i,e,n)=>{if(n.m&&!n.m.l.size&&!Array.from(n.m.t).some(s=>{var o;return(o=t(s).m)==null?void 0:o.d.has(e)})){const s=n.m.u;s&&I(i,s),delete n.m;for(const o of n.d.keys()){const l=D(i,o,t(o));l==null||l.t.delete(e)}return}return n.m};return{get:V,set:L,sub:(i,e)=>{const n=g(),s=t(i),o=j(n,i,s);p(n);const l=o.l;return l.add(e),()=>{l.delete(e);const u=g();D(u,i,s),p(u)}},unstable_derive:i=>J(...i(t,r,c,a))}},Q=M("createStore",()=>{const t=new WeakMap;return J(r=>{let c=t.get(r);return c||(c={d:new Map,p:new Set,n:0},t.set(r,c)),c},(r,...c)=>r.read(...c),(r,...c)=>r.write(...c),(r,...c)=>{var a;return(a=r.onMount)==null?void 0:a.call(r,...c)})});let C;const Z=M("getDefaultStore",()=>(C||(C=Q()),C))}}});
